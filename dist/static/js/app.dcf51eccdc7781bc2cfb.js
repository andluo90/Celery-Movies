webpackJsonp([1],{"8REu":function(t,e){},"9egF":function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("7+uW"),a=i("Dd8w"),o=i.n(a),n=i("NYxO"),r={name:"Footer",computed:o()({},Object(n.b)(["currentTab"])),methods:{toggleTab:function(t){if(this.currentTab!==t){var e={tab:t};this.$store.commit("toggleTab",e)}}}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"footer"},[i("router-link",{attrs:{to:"/"}},[i("div",{staticClass:"wrapper",class:"Top"===t.currentTab?"active":"",on:{click:function(e){return t.toggleTab("Top")}}},[i("span",{staticClass:"iconfont icon-top250"}),t._v(" "),i("span",[t._v("Top250")])])]),t._v(" "),i("router-link",{attrs:{to:"hot"}},[i("div",{staticClass:"wrapper",class:"Hot"===t.currentTab?"active":"",on:{click:function(e){return t.toggleTab("Hot")}}},[i("span",{staticClass:"iconfont icon-75"}),t._v(" "),i("span",[t._v("热播")])])]),t._v(" "),i("router-link",{attrs:{to:"search"}},[i("div",{staticClass:"wrapper",class:"Search"===t.currentTab?"active":"",attrs:{to:"/search"},on:{click:function(e){return t.toggleTab("Search")}}},[i("span",{staticClass:"iconfont icon-sousuo"}),t._v(" "),i("span",[t._v("搜索")])])]),t._v(" "),i("router-link",{attrs:{to:"like"}},[i("div",{staticClass:"wrapper",class:"Like"===t.currentTab?"active":"",attrs:{to:"/like","data-id":"xihuan"},on:{click:function(e){return t.toggleTab("Like")}}},[i("span",{staticClass:"iconfont icon-xihuan"}),t._v(" "),i("span",[t._v("收藏")])])])],1)},staticRenderFns:[]};var l=i("VU/8")(r,c,!1,function(t){i("8REu")},"data-v-3ecc1ca7",null).exports,v=i("hU7x"),u=i.n(v),m={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"loading"},[e("span",{staticClass:"iconfont icon-Loading"})])}]};var d=i("VU/8")({name:"Loading"},m,!1,function(t){i("QBqV")},"data-v-d01643d6",null).exports,h={name:"Detail",components:{Loading:d},data:function(){return{apikey:this.$store.state.apikey,movie:null}},computed:{movieId:function(){return this.$store.state.movieId},meta_directors:function(){var t="";return this.movie.directors.map(function(e){t+=e.name+"(导演) / "}),t},meta_casts:function(){var t="";return this.movie.casts.map(function(e){t+=e.name+" / "}),t},celebrities:function(){},meta:function(){return this.movie.durations[0]+" / "+this.movie.genres.join(" / ")+" / "+this.meta_directors+this.meta_casts+this.movie.pubdates.join(" / ")},tags:function(){return console.log(this.movie),this.movie.tags.map(function(t){return t})}},methods:{close:function(){this.$store.commit("setIsShowDetail",{isShowDetail:!1,movie:null})},getDetailData:function(){var t=this;u()("//api.douban.com/v2/movie/subject/"+this.movieId+"?apikey="+this.apikey,null,function(e,i){e?(console.log("请求电影详情数据失败."),console.log(e)):(console.log("请求电影详情数据成功."),console.log(i),t.movie=i)})}},created:function(){this.getDetailData()}},f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"detail"}},[null===t.movie?i("Loading"):i("div",{staticClass:"movie_detail"},[i("div",{staticClass:"card"},[i("h1",[t._v(t._s(t.movie.title))]),t._v(" "),i("div",{staticClass:"subject"},[i("div",{staticClass:"left"},[i("p",{staticClass:"ratting"},[i("span",{staticClass:"star"}),t._v(" "),i("strong",{staticClass:"score"},[t._v(t._s(t.movie.rating.average))]),t._v(" "),i("span",{staticClass:"count"},[t._v(t._s(t.movie.ratings_count)+"人评价")])]),t._v(" "),i("p",{staticClass:"meta"},[t._v(t._s(t.meta)+"\n                    ")])]),t._v(" "),i("div",{staticClass:"right"},[i("img",{attrs:{src:t.movie.images.small,alt:""}})])]),t._v(" "),i("div",{staticClass:"channel_tags"},[i("h2",[t._v("所属频道")]),t._v(" "),i("ul",t._l(t.tags,function(e){return i("li",{key:e,staticClass:"channel_tag"},[i("a",{attrs:{href:""}},[t._v(t._s(e))])])}),0)]),t._v(" "),i("div",{staticClass:"intro"},[i("h2",[t._v(t._s(t.movie.title)+"的剧情简介")]),t._v(" "),i("p",{staticClass:"bd"},[t._v("\n                        "+t._s(t.movie.summary)+"  \n                ")])]),t._v(" "),i("div",{staticClass:"celebrities"},[i("h2",[t._v("影人")]),t._v(" "),i("ul",[t._l(t.movie.directors,function(e,s){return i("li",{key:s},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.avatars.small,expression:"director.avatars.small"}],staticClass:"poster"}),t._v(" "),i("span",{staticClass:"name"},[t._v(t._s(e.name))]),t._v(" "),i("span",{staticClass:"role"},[t._v("导演")])])}),t._v(" "),t._l(t.movie.casts,function(e,s){return i("li",{key:s+"cast"},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.avatars.small,expression:"cast.avatars.small"}],staticClass:"poster"}),t._v(" "),i("span",{staticClass:"name"},[t._v(t._s(e.name))]),t._v(" "),i("span",{staticClass:"role"},[t._v("演员")])])})],2)])]),t._v(" "),i("div",{staticClass:"close"},[i("button",{on:{click:t.close}},[t._v("关闭")])])])],1)},staticRenderFns:[]};var p={name:"App",components:{Footer:l,Detail:i("VU/8")(h,f,!1,function(t){i("9egF")},"data-v-69747962",null).exports},computed:{isShowDetail:function(){return this.$store.state.isShowDetail}},mounted:function(){var t=localStorage.getItem("douban_movies");null!==t?(t=JSON.parse(t),this.$store.commit("initLikeList",{data:t})):console.log("like list is null...")}},_={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("transition",{attrs:{name:"fade"}},[this.isShowDetail?e("Detail"):this._e()],1),this._v(" "),e("keep-alive",[e("router-view")],1),this._v(" "),e("Footer")],1)},staticRenderFns:[]};var g=i("VU/8")(p,_,!1,function(t){i("l+fl")},null,null).exports,k=i("/ocq"),b=i("mvHQ"),L=i.n(b),C={name:"MovieItem",props:{movie:{type:Object,required:!0}},computed:{islike:function(){var t=this,e=!1;return this.$store.state.likeList.forEach(function(i){t.movie.id===i.id&&(e=!0)}),e}},methods:{click:function(){0===this.status?this.unlike():this.like()},like:function(){this.$store.commit("like",this.movie)},unlike:function(){this.$store.commit("unlike",this.movie)},showDetail:function(){var t={isShowDetail:!0,id:this.movie.id};this.$store.commit("setIsShowDetail",t)}},filters:{formatPeople:function(t){var e=[];return t.forEach(function(t){e.push(t.name)}),e.join("、")}}},y={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{key:t.movie.id,staticClass:"item",on:{click:t.showDetail}},[i("a",[i("div",{staticClass:"cover"},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.movie.images.small,expression:"movie.images.small"}],attrs:{alt:""}})]),t._v(" "),i("div",{staticClass:"detail"},[i("h2",[t._v(t._s(t.movie.title))]),t._v(" "),i("div",{staticClass:"extra"},[i("span",{staticClass:"score"},[t._v(t._s(t.movie.rating.average))]),t._v(" / "+t._s(t.movie.collect_count)+"收藏\n            ")]),t._v(" "),i("div",{staticClass:"extra"},[t._v(t._s(t.movie.year)+" / "+t._s(t.movie.genres.join("、")))]),t._v(" "),i("div",{staticClass:"extra"},[t._v("导演："+t._s(t._f("formatPeople")(t.movie.directors)))]),t._v(" "),i("div",{staticClass:"extra"},[t._v("主演："+t._s(t._f("formatPeople")(t.movie.casts)))]),t._v(" "),i("transition",{attrs:{name:"fade",mode:"out-in"}},[t.islike?i("span",{key:"lkie",staticClass:"iconfont like icon-heart",class:t.islike?"active":"",on:{click:function(e){return e.stopPropagation(),t.unlike(e)}}}):i("span",{key:"unlike",staticClass:"iconfont like icon-xihuan",on:{click:function(e){return e.stopPropagation(),t.like(e)}}})])],1)])])},staticRenderFns:[]};var $={name:"MovieList",components:{MovieItem:i("VU/8")(C,y,!1,function(t){i("zWZa")},"data-v-7897ba3f",null).exports,Loading:d},props:{data:Array},computed:{isLoading:function(){return this.$store.state.isLoading}}},w={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("transition",{attrs:{name:"fade"}},[this.isLoading?e("Loading",{key:"loading"}):[e("transition-group",{attrs:{name:"list",tag:"p"}},this._l(this.data,function(t){return e("MovieItem",{key:t.id,attrs:{movie:t}})}),1)]],2)],1)},staticRenderFns:[]};var T=i("VU/8")($,w,!1,function(t){i("XOM3")},"data-v-260a9ec3",null).exports,D={name:"Top",components:{MovieList:T},data:function(){return{apikey:this.$store.state.apikey,start:0,count:20,movieList:[],isLoadingMore:!1}},computed:{isLoading:function(){return this.$store.state.isLoading},classes:function(){return this.$store.state.isShowDetail?"hide":""},loadMoreText:function(){return this.start>=240?"已经没有了...":this.isLoadingMore?"正在加载中...":"点击加载更多"}},methods:{loadMore:function(){var t=this;if(this.start>=240)return"";this.isLoadingMore=!0,u()("//api.douban.com/v2/movie/top250?apikey="+this.apikey+"&start="+this.start+"&count="+this.count,null,function(e,i){if(t.$store.commit("setLoading",{status:!1}),e)t.isLoadingMore=!1,console.log("请求失败."),console.log(e);else{console.log("请求成功."),t.isLoadingMore=!1;var s=L()(t.movieList.concat(i.subjects));t.movieList=JSON.parse(s),t.start+=20}})},getData:function(){var t=this;this.$store.commit("setLoading",{status:!0}),u()("//api.douban.com/v2/movie/top250?apikey="+this.apikey+"&start="+this.start+"&count="+this.count,null,function(e,i){t.$store.commit("setLoading",{status:!1}),e?(console.log("请求失败."),console.log(e)):(console.log("请求成功."),t.movieList=i.subjects,t.start+=20)})}},beforeMount:function(){this.getData()},mounted:function(){this.$store.commit("toggleTab",{tab:"Top"})}},M={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"top",class:t.classes},[i("MovieList",{attrs:{data:t.movieList}}),t._v(" "),t.isLoading?t._e():i("div",{staticClass:"more",on:{click:t.loadMore}},[t._v(t._s(t.loadMoreText))])],1)},staticRenderFns:[]};var x=i("VU/8")(D,M,!1,function(t){i("RWfd")},"data-v-b51b446e",null).exports,S={name:"Hot",components:{MovieList:T},data:function(){return{apikey:this.$store.state.apikey,movieList:null}},computed:{isLoading:function(){return this.$store.state.isLoading},classes:function(){return this.$store.state.isShowDetail?"hide":""}},beforeMount:function(){var t=this;this.$store.commit("setLoading",{status:!0}),u()("//api.douban.com/v2/movie/in_theaters?apikey="+this.apikey,null,function(e,i){t.$store.commit("setLoading",{status:!1}),e?(console.log("请求失败."),console.log(e)):(console.log("请求成功."),t.movieList=i.subjects)})},mounted:function(){this.$store.commit("toggleTab",{tab:"Hot"})}},E={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"hot",class:this.classes},[e("MovieList",{attrs:{data:this.movieList}}),this._v(" "),this.isLoading?this._e():e("div",{staticClass:"more"},[this._v("已经没有了...")])],1)},staticRenderFns:[]};var F=i("VU/8")(S,E,!1,function(t){i("V1Tt")},"data-v-05552964",null).exports,V={name:"Search",components:{MovieList:T},data:function(){return{apikey:"0b2bdeda43b5688921839c8ecb20399b",value:"",movieList:[]}},computed:{classes:function(){return this.$store.state.isShowDetail?"hide":""}},methods:{search:function(){var t=this;console.log("search "+this.value),u()("//api.douban.com/v2/movie/search?apikey="+this.apikey+"&q="+this.value,null,function(e,i){e?(console.log("搜索失败."),console.log(e)):(success=!0,console.log("搜索成功."),t.movieList=i.subjects)})}},mounted:function(){this.$store.commit("toggleTab",{tab:"Search"})}},I={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"search",class:t.classes},[i("div",{staticClass:"wrap"},[i("div",{staticClass:"search-area"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],attrs:{type:"search",placeholder:"搜索电影"},domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}}),t._v(" "),i("span",{staticClass:"button searching",on:{click:t.search}},[t._v("搜索")])]),t._v(" "),t._m(0)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"search-reslut"},[e("div",{staticClass:"container"},[e("div",{staticClass:"error"},[e("div",[e("span",{staticClass:"iconfont icon-error"})]),this._v(" "),e("div",[this._v("豆瓣搜索接口异常!")]),this._v(" "),e("div",[this._v("请等其恢复，非常报歉!")])])])])}]};var R=i("VU/8")(V,I,!1,function(t){i("Vwrv")},"data-v-5433e344",null).exports,j={name:"Like",components:{MovieList:T},computed:{movieList:function(){return this.$store.state.likeList},classes:function(){return this.$store.state.isShowDetail?"hide":""}},mounted:function(){this.$store.commit("toggleTab",{tab:"Like"})}},U={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"like",class:t.classes},[i("transition",{attrs:{name:"fade"}},[0===t.movieList.length?i("div",{staticClass:"empty"},[i("span",{staticClass:"iconfont icon-empty"}),t._v(" "),i("div",{staticClass:"desc"},[t._v("暂无收藏哦.")])]):t._e()]),t._v(" "),0!==t.movieList.length?i("MovieList",{attrs:{data:t.movieList}}):t._e()],1)},staticRenderFns:[]};var O=i("VU/8")(j,U,!1,function(t){i("nqv3")},"data-v-48bf9702",null).exports;s.a.use(k.a);var N=new k.a({routes:[{path:"/",name:"Top",component:x},{path:"/hot",name:"Hot",component:F},{path:"/search",name:"Search",component:R},{path:"/like",name:"Like",component:O}]}),z=(i("OMJi"),i("BO1k")),H=i.n(z),q=i("d7EF"),P=i.n(q),W=i("Gu7T"),A=i.n(W);s.a.use(n.a);var J=new n.a.Store({state:{isLoading:!1,currentTab:"top",likeList:[],apikey:"0b2bdeda43b5688921839c8ecb20399b",isShowDetail:!1,movieId:null},mutations:{toggleTab:function(t,e){t.currentTab=e.tab},initLikeList:function(t,e){var i;(i=t.likeList).splice.apply(i,[0,0].concat(A()(e.data)))},like:function(t,e){t.likeList.unshift(e),localStorage.setItem("douban_movies",L()(t.likeList))},unlike:function(t,e){var i=t.likeList,s=null,a=!0,o=!1,n=void 0;try{for(var r,c=H()(i.entries());!(a=(r=c.next()).done);a=!0){var l=r.value,v=P()(l,2),u=v[0],m=v[1];if(e.id===m.id){s=u;break}}}catch(t){o=!0,n=t}finally{try{!a&&c.return&&c.return()}finally{if(o)throw n}}i.splice(s,1),localStorage.setItem("douban_movies",L()(i))},setLoading:function(t,e){t.isLoading=e.status},setIsShowDetail:function(t,e){t.isShowDetail=e.isShowDetail,t.movieId=e.id}}}),B=i("mtWM"),Q=i.n(B),X=i("AXdl");s.a.prototype.$http=Q.a,s.a.config.productionTip=!1,s.a.use(X.a,{loading:"http://img3.doubanio.com/f/movie/b6dc761f5e4cf04032faa969826986efbecd54bb/pics/movie/movie_default_small.png",error:"http://img3.doubanio.com/f/movie/b6dc761f5e4cf04032faa969826986efbecd54bb/pics/movie/movie_default_small.png"}),new s.a({el:"#app",router:N,store:J,components:{App:g},template:"<App/>"})},QBqV:function(t,e){},RWfd:function(t,e){},V1Tt:function(t,e){},Vwrv:function(t,e){},XOM3:function(t,e){},"l+fl":function(t,e){},nqv3:function(t,e){},zWZa:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.dcf51eccdc7781bc2cfb.js.map